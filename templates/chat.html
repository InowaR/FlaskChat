<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta charset="UTF-8">
        <title>Главная страница</title>
        <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    </head>
    <body>
		<div class="header">
			<form action="{{ url_for('get_list_chats') }}" method="get">
			<input class="logo" type="submit" value="Главная страница">
			</form>
			<div class="header-right">
				<form action="{{ url_for('get_profile') }}" method="get">
				<input type="submit" value="Профиль">
				</form>
				<form action="{{ url_for('get_logout') }}" method="get">
				<input type="submit" value="Выйти">
				</form>
			</div>
		</div>
		<h1>Чат</h1>
		<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
		<style>
			ul {
				height: 300px;
				width: 300px;
				overflow-y: scroll;
			}

			li {
				height: min-content;
				width: min-content;
				list-style: none;
				background-color: grey;
			}

			#message {
				width: 300px;
			}
		</style>
		<div id="chat">
			<ul id="chat-messages"></ul>
			<input type="text" id="message" placeholder="Введите сообщение:">
		</div>
		<script>
			const socket = io();
			document.getElementById("message").addEventListener("keyup", function(event) {
				if (event.key == "Enter") {
					let message = document.getElementById("message").value;
					socket.emit("new_message", message);
					document.getElementById("message").value = "";
				}
			})
			socket.on("chat", function(data) {
				let ul = document.getElementById("chat-messages");
				let li = document.createElement("li");
				let br = document.createElement("br");
				li.appendChild(document.createTextNode(data["username"] + ": " + data["message"]));
				ul.appendChild(li);
				ul.appendChild(br);
			})
		</script>
    </body>
</html>
